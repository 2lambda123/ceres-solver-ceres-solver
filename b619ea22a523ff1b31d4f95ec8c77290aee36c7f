{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "fb978455_11e2b61c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 5002
      },
      "writtenOn": "2024-05-31T15:08:51Z",
      "side": 1,
      "message": "PTAL",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fdb4d734_b451faf9",
        "filename": "internal/ceres/CMakeLists.txt",
        "patchSetId": 8
      },
      "lineNbr": 393,
      "author": {
        "id": 6612
      },
      "writtenOn": "2024-06-03T19:10:49Z",
      "side": 1,
      "message": "Unfortunately, this is not sufficient on Ubuntu and causes errors such as\n```cmake\nCMake Error at internal/ceres/CMakeLists.txt:416 (target_link_libraries):\n  Target \"array_utils_test\" links to:\n\n    GTest::gmock_main\n\n  but the target was not found.  Possible reasons include:\n\n    * There is a typo in the target name.\n    * A find_package call is missing for an IMPORTED target.\n    * An ALIAS target is missing.\n\nCall Stack (most recent call first):\n  internal/ceres/CMakeLists.txt:429 (ceres_test)\n```\n\nI\u0027d suggest\n```suggestion\n  find_package(GTest REQUIRED COMPONENTS GTest GMock CONFIG)\n  include(GoogleTest)\n```",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1b7f96e_ae67cd17",
        "filename": "internal/ceres/CMakeLists.txt",
        "patchSetId": 8
      },
      "lineNbr": 393,
      "author": {
        "id": 5002
      },
      "writtenOn": "2024-06-05T03:58:08Z",
      "side": 1,
      "message": "I had updated my local copy to say \n\n find_package(GTest 1.14.0 REQUIRED)\n \n but I can change it to the version you have recommended including the version number which is what introduced SrcDir()",
      "parentUuid": "fdb4d734_b451faf9",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "485bccda_84a1eb43",
        "filename": "internal/ceres/CMakeLists.txt",
        "patchSetId": 8
      },
      "lineNbr": 393,
      "author": {
        "id": 6612
      },
      "writtenOn": "2024-06-09T09:57:06Z",
      "side": 1,
      "message": "The open question now is how do we deal with Ubuntu 22.04 which ships an older Google Test 1.11. Does the user need to build 1.14 from source? If so, we probably need want to update the documentation as well.",
      "parentUuid": "e1b7f96e_ae67cd17",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "387c51ca_15cdde7b",
        "filename": "internal/ceres/CMakeLists.txt",
        "patchSetId": 8
      },
      "lineNbr": 393,
      "author": {
        "id": 5002
      },
      "writtenOn": "2024-06-09T19:03:14Z",
      "side": 1,
      "message": "that would explain why my attempts at getting my workflow tests to work were failing.\n\nFrankly I am not sure what the right thing to do here is. 22.04 is not a terribly old release, so breaking the build on it does not sound like a great idea. It is also going to be supported till 2027, waiting till then to update things does not sound like a great idea either.\n\nso here is another idea.\n\nwe go back to packaging googletest with ceres, but we do not use the gflags/custom main function, which will break the dependency on gflags and we can assume that testing::SrcDir() is always available to us. \n\nThis latter bit is a bigger deal than packaging googletest with ceres, because it unblocks the abseil transition. \n\nI suspect we are going to have a similar conversation about abseil, since we need the release from 2024 which has vlog in it for us to be able to use abseil, and the version in 22.04 is much older.\n\nif we decide to go down this route, then what is the simplest and cleanest way to package googletest and build it using its own cmake file instead of the custom stuff we were doing earlier?\n\ndo I just download the googletest repo as a subdirectory in ceres/internal and add_subdirectory(googletest) on it in the cmake file?",
      "parentUuid": "485bccda_84a1eb43",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "40cae28a_8321a7f1",
        "filename": "internal/ceres/CMakeLists.txt",
        "patchSetId": 8
      },
      "lineNbr": 393,
      "author": {
        "id": 6612
      },
      "writtenOn": "2024-06-09T19:42:12Z",
      "side": 1,
      "message": "Embedding GoogleTest as a submodule and including it via `add_subdirectory` is the easiest and cleanest approach for tracking the upstream. However, we would have an issue if we need to patch the sources, i.e., we would not be able to push the changes unless we track the submodule from a GoogleTest fork (e.g., managed by Ceres Solver). Also personally, I would still prefer to use a prepackaged GoogleTest, e.g., installed through a package manager, to avoid compiling GoogleTest altogether.\n\nAnother suggestion: in case `testing::SrcDir` is the only reason we require GoogleTest 1.14, can\u0027t we just backport the function\u0027s implementation to `test_util` and use it as a fallback for GTest\u003c1.14? This way we can avoid bundling GoogleTest on Ubuntu.",
      "parentUuid": "387c51ca_15cdde7b",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be108bcd_e44f728d",
        "filename": "internal/ceres/CMakeLists.txt",
        "patchSetId": 8
      },
      "lineNbr": 426,
      "author": {
        "id": 6612
      },
      "writtenOn": "2024-06-03T19:10:49Z",
      "side": 1,
      "message": "Using `gtest_discover_tests` has a nasty side effect. In case we cross-compile the build will fail because CMake will try to run the executables to figure out the test names which obviously cannot succeed:\n\nhttps://github.com/sergiud/ceres-solver/actions/runs/9355681877/job/25751382174#step:20:193\n\nBeing able to cross-compile unit tests is a common use case in my opinion.",
      "range": {
        "startLine": 426,
        "startChar": 4,
        "endLine": 426,
        "endChar": 24
      },
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "61757a06_ed39bb7f",
        "filename": "internal/ceres/CMakeLists.txt",
        "patchSetId": 8
      },
      "lineNbr": 426,
      "author": {
        "id": 5002
      },
      "writtenOn": "2024-06-05T03:58:08Z",
      "side": 1,
      "message": "okay back to add_test then",
      "parentUuid": "be108bcd_e44f728d",
      "range": {
        "startLine": 426,
        "startChar": 4,
        "endLine": 426,
        "endChar": 24
      },
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2b40a417_7a6623fd",
        "filename": "internal/ceres/CMakeLists.txt",
        "patchSetId": 8
      },
      "lineNbr": 426,
      "author": {
        "id": 6612
      },
      "writtenOn": "2024-06-09T09:57:06Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "61757a06_ed39bb7f",
      "range": {
        "startLine": 426,
        "startChar": 4,
        "endLine": 426,
        "endChar": 24
      },
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8915b215_5c753cbc",
        "filename": "internal/ceres/test_util.cc",
        "patchSetId": 8
      },
      "lineNbr": 136,
      "author": {
        "id": 6612
      },
      "writtenOn": "2024-06-03T19:10:49Z",
      "side": 1,
      "message": "Unfortunately, this does not work with gtest bundled with Ubuntu 22.04: https://github.com/sergiud/ceres-solver/actions/runs/9355681880/job/25751382923#step:12:175\n\nWe probably need to set the minimum version of GTest that introduced `SrcDir()`.",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f697891a_0ac94d4b",
        "filename": "internal/ceres/test_util.cc",
        "patchSetId": 8
      },
      "lineNbr": 136,
      "author": {
        "id": 5002
      },
      "writtenOn": "2024-06-05T03:58:08Z",
      "side": 1,
      "message": "yeah we need 1.14.0\n\nhttps://packages.ubuntu.com/search?keywords\u003dgoogletest",
      "parentUuid": "8915b215_5c753cbc",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bddbc57a_2a744faf",
        "filename": "internal/ceres/test_util.cc",
        "patchSetId": 8
      },
      "lineNbr": 136,
      "author": {
        "id": 5002
      },
      "writtenOn": "2024-06-05T04:02:03Z",
      "side": 1,
      "message": "if testing::SrcDir() is not available I can hardcode it as \"./bin\" for now, which is what it is right now. would that work?",
      "parentUuid": "f697891a_0ac94d4b",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "26817291_b0e08cdf",
        "filename": "internal/ceres/test_util.cc",
        "patchSetId": 8
      },
      "lineNbr": 136,
      "author": {
        "id": 6612
      },
      "writtenOn": "2024-06-09T09:57:06Z",
      "side": 1,
      "message": "This will likely work with the two mentioned restrictions remaining. However, if we use the approach we should not require GoogleTest 1.14 but instead relax the version requirement to 1.11.",
      "parentUuid": "bddbc57a_2a744faf",
      "revId": "b619ea22a523ff1b31d4f95ec8c77290aee36c7f",
      "serverId": "cdcfcfbe-2044-3b1f-b5d4-da77ad542329"
    }
  ]
}